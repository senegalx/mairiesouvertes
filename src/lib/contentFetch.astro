---
import client from './api/apollo-client';
import { MembreListDocument } from './gql/generated';

export async function getMembreList() {
  const { data } = await client.query({
    query: MembreListDocument,
  });

  const members = data.membres.nodes.map(membre => {
  const socialArray = Object.keys(membre.social)
    .filter(key => key !== '__typename')
    .map(key => {
      const platformName = `Fa${key.charAt(0).toUpperCase()}${key.slice(1)}`;
      return {
        platform: platformName,
        url: membre.social[key]
      };
    });

  return {
    ...membre, // Copie toutes les autres propriétés de membre
    social: socialArray // Remplace la propriété social par le nouveau tableau
  };
});

  return members;
}
---